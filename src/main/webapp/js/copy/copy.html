<html>
<head>
	<meta charset=utf-8 />
</head>
<body>

<h2>example for copy to clipboard</h2>
comes from <a href="https://www.cnblogs.com/xhyu/p/5370111.html" target=_blank>here</a>
and <a href="https://stackoverflow.com/questions/33855641/copy-output-of-a-javascript-variable-to-the-clipboard" target=_blank>here</a>

<br/><br/>


<button type="button" onclick="copy2Clipboard();">copy a dynamic content to Clipboard</button>
<br/>
<h2> This button will create a rich text table in the memory , then copy it into the Clipboard</h2>
<h2> please paste into any text editor after you click this button</h2>
<h2> it will show you rich text if you copy it into MS Excel</h2>

<script>
function copy2Clipboard(){


	var div = document.createElement('div');
	
	var span = document.createElement('span');
	span.innerText="generated content";
	div.appendChild(span);
	
	
	var h2 = document.createElement('h2');
	h2.innerText="generated content2222";
	div.appendChild(h2);
	
	var table = createTable();
	div.appendChild(table);

	copyToClipboard(div.innerHTML);
}

function createTable(){

	var items = [
	  ["abc", "def2"],
	  ["fhsas", "html tag <br/>"]
	];

	var targetTable = document.createElement("table");

	// populate targetTable with cells
	items.forEach(function(row) {
		//create row and append to table
		var domTR = document.createElement("tr");
		targetTable.appendChild(domTR);
		//create TD and append to row
		for (var i = 0; i < row.length; i++) {
			var domTD = document.createElement("td");
			domTD.innerText = row[i];
			//domTD.innerHTML = row[i];
			domTR.appendChild(domTD);			
		}
	});
	
	return targetTable;
	
}

function copyToClipboard(text) {
    var dummy = document.createElement("textarea");
    // to avoid breaking orgain page when copying more words
    // cant copy when adding below this code
    // dummy.style.display = 'none'
    document.body.appendChild(dummy);
    //Be careful if you use texarea. setAttribute('value', value), which works with "input" does not work with "textarea". â€“ Eduard
    dummy.value = text;
    dummy.select();
    document.execCommand("copy");
    document.body.removeChild(dummy);
}

</script>


</body>

</html>