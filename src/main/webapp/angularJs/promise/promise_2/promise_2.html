<html ng-app="PersonApp">
    <head>
        <meta charset="utf-8">

        <title>Angular layer Example</title>
        
<style type="text/css">


table.peopleListTable{
	table-layout: fixed;
	border-spacing: 1px;
}

table.peopleListTable tr td, table.peopleListTable tr th{
	white-space: nowrap;
	overflow: hidden;
	padding: 1px;
  	padding-left: 2px;
  	padding-right: 2px;	
}
table.peopleListTable tr + tr {
    border-top: 0px;
    border-bottom: 0px;
}

table.peopleListTable tr:nth-child(even), table.peopleListTable thead tr  {
    background-color: #ddd;
}

</style>        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.28/angular.js"></script>

        <script src="countryService.js"></script>
        <script src="countryField.js"></script>
        <script src="promise_2.js"></script>


    </head>
    <body ng-controller="PersonCtrl">
        <h1>demo how to set AngularJS layer</h1>
        <ul>
            <li> App->controller->directive -> service</li>
            <li> reuse http request in the service for multiple directive instances </li>
            <li> use $q and promise to coordinate multiple http requests  </li>
            <li> directive can handle many errors  </li>
            <li> use setTimeout to simulate slow API call</li>
        </ul>
        <button ng-click="loadPerson(false,false)">query correct data</button>
        <button ng-click="loadPerson(true, false)">query wrong person data</button>
        <button ng-click="loadPerson(false, true)">query wrong country data</button>

        <br/><label style="color: red">{{errMsg}}</label>
        <br/>

        <table class="peopleListTable">
            <thead>
                <tr>
                    <th width="100">ID</th>
                    <th width="150">Name</th>
                    <th width="80">CitizenId</th>
                    <th width="190" >Citizen</th>
                    <th width="190" >Citizen(readOnly)</th>
                    <th width="80">BirthiD</th>
                    <th width="190">Birth</th>
                </tr>
            </thead>
            <tbody>
                <tr ng-repeat="p in person">
                    <td> {{p.ID}} </td>
                    <td> {{p.name}} </td>
                    <td> {{p.citizen}}</td>
                    <td> <country.field field="p.citizen" read-only="false" ></country.field></td>
                    <td> <country.field field="p.citizen" read-only="true" ></country.field></td>
                    <td> {{p.birth}} </td>
                    <td> <country.field field="p.birth" read-only="false"></country.field> </td>
</tr>
</tbody>
</table>



<br/>

please see 
<a href = "http://blog.parse.com/learn/engineering/whats-so-great-about-javascript-promises/" target=_blank>here</a>
for benefits

</body>
</html>